# NDB Cluster 硬件、软件和网络要求

NDB Cluster 的优势之一是它可以在商用硬件上运行，并且在这方面没有异常要求，除了大量 RAM，因为所有实时数据存储都在内存中完成。 （可以使用磁盘数据表来降低此要求——有关这些的更多信息，请参见[第 23.6.10 节，“NDB Cluster 磁盘数据表”](https://dev.mysql.com/doc/refman/8.0/en/mysql-cluster-disk-data.html)。）自然，多个更快的 CPU 可以提高性能。其他 NDB Cluster 进程的内存需求相对较小。

NDB Cluster 的软件要求也适中。主机操作系统不需要任何不寻常的模块、服务、应用程序或配置来支持 NDB Cluster。对于支持的操作系统，标准安装就足够了。 MySQL 软件要求很简单：只需要​​ NDB Cluster 的生产版本。仅仅为了能够使用 NDB Cluster，不必自己编译 MySQL。我们假设您正在使用适合您平台的二进制文件，可从 NDB Cluster 软件下载页面 <https://dev.mysql.com/downloads/cluster/> 获得。

对于节点之间的通信，NDB Cluster 支持任何标准拓扑中的 TCP/IP 网络，并且每个主机的最低要求是标准的 100 Mbps 以太网卡，以及为整个集群提供网络连接的交换机、集线器或路由器.我们强烈建议 NDB Cluster 在其自己的子网上运行，该子网不与不属于集群的机器共享，原因如下：

- **安全**。 NDB Cluster 节点之间的通信不会以任何方式加密或屏蔽。保护 NDB Cluster 内传输的唯一方法是在受保护的网络上运行 NDB Cluster。如果您打算将 NDB Cluster 用于 Web 应用程序，则该集群绝对应该位于防火墙后面，而不是位于网络的非军事区 ([DMZ](http://compnetworking.about.com/cs/networksecurity/g/bldef_dmz.htm)) 或其他地方。
有关更多信息，请参阅[第 23.6.18.1 节，“NDB 集群安全和网络问题”](https://dev.mysql.com/doc/refman/8.0/en/mysql-cluster-security-networking-issues.html)。
- **效率**。在私有或受保护的网络上设置 NDB Cluster 使集群能够独占使用集群主机之间的带宽。为 NDB Cluster 使用单独的开关不仅有助于防止未经授权访问 NDB Cluster 数据，还可以确保 NDB Cluster 节点免受网络上其他计算机之间的传输造成的干扰。为了增强可靠性，您可以使用双交换机和双卡来消除网络作为单点故障；许多设备驱动程序支持此类通信链路的故障转移。

网络通信和延迟。 NDB Cluster 需要数据节点和 API 节点（包括 SQL 节点）之间以及数据节点和其他数据节点之间的通信来执行查询和更新。这些进程之间的通信延迟会直接影响观察到的用户查询的性能和延迟。此外，为了在节点静默故障的情况下保持一致性和服务，NDB Cluster 使用心跳和超时机制，将来自节点的长时间通信丢失视为节点故障。这会导致冗余减少。回想一下，为了保持数据一致性，当节点组中的最后一个节点发生故障时，NDB Cluster 会关闭。因此，为避免增加强制关闭的风险，应尽可能避免节点之间的通信中断。

数据或 API 节点的故障会导致涉及故障节点的所有未提交事务中止。数据节点恢复需要从幸存的数据节点同步故障节点的数据，并在数据节点恢复服务之前重新建立基于磁盘的重做和检查点日志。此恢复可能需要一些时间，在此期间集群以减少的冗余运行。

心跳依赖于所有节点及时生成心跳信号。如果节点过载，由于与其他程序共享而导致机器 CPU 不足，或者由于交换而遇到延迟，这可能是不可能的。如果心跳生成被充分延迟，其他节点会将响应缓慢的节点视为失败。

在某些情况下，将慢速节点视为故障节点可能是可取的，也可能是不可取的，这取决于节点的慢速操作对集群其余部分的影响。在为 NDB Cluster 设置超时值（例如 HeartbeatIntervalDbDb 和 HeartbeatIntervalDbApi）时，必须注意实现快速检测、故障转移和恢复服务，同时避免潜在的代价高昂的误报。

如果数据节点之间的通信延迟预计高于 LAN 环境中的预期（大约 100 µs），则必须增加超时参数以确保任何允许的延迟周期都在配置的超时范围内。以这种方式增加超时对检测故障的最坏情况时间以及服务恢复时间有相应的影响。

LAN 环境通常可以配置为具有稳定的低延迟，这样它们就可以通过快速故障转移提供冗余。可以在 TCP 级别（NDB Cluster 正常运行的地方）以最小且受控的延迟从单个链路故障中恢复。 WAN 环境可能会提供一系列延迟，以及具有较慢故障转移时间的冗余。单个链路故障可能需要在端到端连接恢复之前传播路由更改。在 TCP 级别，这可能表现为单个通道上的大延迟。在这些场景中观察到的最坏情况 TCP 延迟与 IP 层围绕故障重新路由的最坏情况时间有关。
